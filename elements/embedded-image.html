<vue-module id="embedded-image">
  <style>
    .embedded-image .text {
      text-align: center;
      float: left;
    }
  </style>

  <template>
    <div style="padding: 1em;">
      <img ref="image" :style="imgStyle" :src="url" :alt="alt" v-on:load="imgsize">
      </img>

      <br>
      <i class="text" :style="{ width: textwidth }" v-show="hastext">{{text}}</i>
    </div>
  </template>

  <script>
    Vue.module('embedded-image', {
      data: function () {
        return {
          textwidth: null,
        };
      },

      props: {
        url: String,
        alt: {
          type: String,
          default: '',
        },
        text: {
          type: String,
          default: '',
        },
        imgStyle: {
          type: String,
          default: '',
        },
      },

      methods: {
        imgsize: function () {
          this.textwidth = this.$refs.image.clientWidth + 'px';
        },
      },

      computed: {
        hastext: function () { return this.text.length > 0; },
      },

      mounted: function () {
        $(window).resize(this.imgsize.bind(this));
      },
    });
  </script>
</vue-module>
