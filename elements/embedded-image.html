<vue-module id="embedded-image">
  <template>
    <div style="padding: 1em;">
      <img ref="image" :style="imgStyle" :src="url" :alt="alt" v-on:load="imgload">
      </img>

      <i :style="textStyle" v-if="hastext">{{text}}</i>
    </div>
  </template>

  <script>
    Vue.module('embedded-image', {
      data: function () {
        return {
          textStyle: '',
        };
      },

      props: {
        url: String,
        alt: {
          type: String,
          default: '',
        },
        text: {
          type: String,
          default: '',
        },
        imgStyle: {
          type: String,
          default: '',
        },
      },

      methods: {
        imgload: function () {
          this.textStyle = 'width: ' + this.$refs.image.clientWidth + ';';
        },
      },

      computed: {
        hastext: function () { return this.text.length > 0; },
      },
    });
  </script>
</vue-module>
