<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>The Magic of RPython | BlockByte</title>

    
            <link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">

      <link rel="canonical" href="http://kirbyfan64.github.io/posts/the-magic-of-rpython.html">



    
        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    


    

    <meta name="author" content="Ryan Gonzalez">
    
        <meta name="og:title" content="The Magic of RPython">
        <meta name="og:url" content="http://kirbyfan64.github.io/posts/the-magic-of-rpython.html">
            <meta name="og:description" content="RPython is a really nice translation framework that converts a (very) restricted subset of Python 2 to C code. Better yet, RPython will generate JITs for your interpreters. Although there are very goo">
        <meta name="og:site_name" content="BlockByte">
        <meta name="og:type" content="article">

    

    



</head>
<body>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://kirbyfan64.github.io/">

                <span id="blog-title">BlockByte</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li>
<a href="../archive.html">Archive</a>
                </li>
<li>
<a href="../categories/index.html">Tags</a>
                </li>
<li>
<a href="../rss.xml">RSS feed</a>
            </li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown">Randomness<b class="caret"></b></a>
            <ul class="dropdown-menu">
                    <li>
<a href="../pages/randomness.html">Index</a>
                    </li>
<li>
<a href="../pages/katex.html">KaTeX Previewer</a>
            </li>
</ul>

                
            </li>
</ul>

            <ul class="nav navbar-nav navbar-right">
                
                
                    
    <li>
    <a href="the-magic-of-rpython.rst" id="sourcelink">Source</a>
    </li>

                
            </ul>
        </div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav>

<!-- End of Menubar -->

<div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
    
    <header>
        
    <h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">The Magic of RPython</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Ryan Gonzalez</span></p>
            <p class="dateline"><a href="#" rel="bookmark"><time class="published dt-published" datetime="2015-05-29T19:19:38-05:00" itemprop="datePublished" title="Publication date">2015-05-29 19:19</time></a></p>
                <p class="commentline">
        
    <a href="the-magic-of-rpython.html#disqus_thread" data-disqus-identifier="cache/posts/the-magic-of-rpython.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="the-magic-of-rpython.rst" id="sourcelink">Source</a></p>

        </div>
        

    </header>

    <div class="e-content entry-content" itemprop="articleBody text">
    <p><a class="reference external" href="http://rpython.readthedocs.org/en/latest/">RPython</a> is a really nice translation framework that converts a (very) restricted subset of Python 2 to C code. Better yet, RPython will generate JITs for your interpreters. Although there are very good articles on how to write interpreters with RPython, I don't often find anything that describes the language itself. My goal with this post is to do just that: describe RPython itself. I'm going to leave out the things about the JITs; the RPython FAQ links to a good tutorial about that.</p>
<!-- TEASER_END -->
<div class="section" id="rpython-enters-and-exits">
<h2>RPython enters and exits</h2>
<p>Your RPython programs/interpreters will often begin like this:</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">entry_point</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="c"># this is your program's main function</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
    <span class="c"># this is run at compile time</span>
    <span class="k">return</span> <span class="n">entry_point</span><span class="p">,</span> <span class="bp">None</span>
</pre>
<p>You'd run RPython kind of like this:</p>
<pre class="literal-block">
$ python path_to_pypy_source/rpython/bin/rpython -O0 my_program.py
</pre>
<p>The <tt class="docutils literal"><span class="pre">-O0</span></tt> turns off all optimizations, which makes compile times <em>much</em> faster while testing.</p>
<p>If you're lazy like me, you can define an alias:</p>
<pre class="literal-block">
$ alias rpython="python path_to_pypy_source/rpython/bin/rpython"
</pre>
<p>The <tt class="docutils literal">target</tt> function lets you set certain or check command-line arguments passed to RPython. For instance:</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
    <span class="c"># The default output file name for xyz.py is xyz-c</span>
    <span class="k">if</span> <span class="n">driver</span><span class="o">.</span><span class="n">exe_name</span> <span class="o">==</span> <span class="s">'xyz-c'</span><span class="p">:</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">exe_name</span> <span class="o">=</span> <span class="s">'bin/xyz'</span>
    <span class="k">return</span> <span class="n">entry_point</span><span class="p">,</span> <span class="bp">None</span>
</pre>
<p>I have <em>no</em> clue what the <tt class="docutils literal">None</tt> is for, though.</p>
<p><strong>EDIT:</strong> As Chris pointed out in the comments and Maciej Fijalkowski in an e-mail, the <tt class="docutils literal">None</tt> represents the type of the arguments that are given to <tt class="docutils literal">entry_point</tt>. See <a class="reference external" href="https://bitbucket.org/pypy/pypy/src/tip/rpython/translator/goal/targetrpystonex.py?at=py3k">rpython/translator/goal/targetrpystonex.py</a> for an example.</p>
</div>
<div class="section" id="rpython-is-half-python-half-not-python-and-python">
<h2>RPython is half-Python, half-not-Python, and Python</h2>
<p>Notice that I said that <tt class="docutils literal">target</tt> is run at compile time. While other Python translation frameworks, such as Shedskin and Cython, analyse the program's static AST, RPython analyses its bytecode. Here's an example:</p>
<pre class="code python literal-block">
<span class="k">print</span> <span class="s">'This is run during compile time!'</span> <span class="c"># guess when this is run?</span>

<span class="k">def</span> <span class="nf">entry_point</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">'This is run at run time!'</span>
    <span class="k">return</span> <span class="mi">0</span>
</pre>
<p>This has really cool implications. For one thing, RPython lazily compiles functions. For instance:</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
    <span class="c"># This is never compiled by RPython because 'f' is never called</span>
    <span class="k">return</span> <span class="mi">123</span>

<span class="k">def</span> <span class="nf">g</span><span class="p">():</span>
    <span class="c"># This is compiled by RPython because 'g' *is* called</span>
    <span class="k">return</span> <span class="mi">456</span>

<span class="k">def</span> <span class="nf">entry_point</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">g</span><span class="p">()</span>
</pre>
<p>That means we can do lots of compile-time computations:</p>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">'windows'</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">plat</span><span class="p">():</span> <span class="k">return</span> <span class="s">'Windows!'</span>
<span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">'linux'</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">plat</span><span class="p">():</span> <span class="k">return</span> <span class="s">'Linux!'</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">plat</span><span class="p">():</span> <span class="k">return</span> <span class="s">'Who cares?'</span>

<span class="k">def</span> <span class="nf">entry_point</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">plat</span><span class="p">()</span>
    <span class="k">return</span> <span class="mi">0</span>
</pre>
</div>
<div class="section" id="rpython-is-statically-typed">
<h2>RPython is statically-typed</h2>
<p>In short:</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">entry_point</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">123</span> <span class="c"># ok</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s">'456'</span> <span class="c"># error!</span>
</pre>
<p>Notice that no variable annotations were needed. This is because RPython uses type inference.</p>
<p>RPython also performs compile-time null checking under certain situations:</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">entry_point</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">print</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span> <span class="c"># compile-time error</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">entry_point</span><span class="p">,</span> <span class="bp">None</span>
</pre>
</div>
<div class="section" id="rpython-has-confusing-error-messages">
<h2>RPython has confusing error messages</h2>
<p>Whenever an error occurs during compilation, most compilers will output something like:</p>
<pre class="literal-block">
error: myfile.whatever:22: variable 'xyz' may be 'null' when used here
</pre>
<p>Not RPython! This is what I get when I try to compile the above snippet:</p>
<pre class="literal-block">
[translation:info] Error:
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/goal/translate.py", line 316, in main
[translation:info]     drv.proceed(goals)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/driver.py", line 539, in proceed
[translation:info]     return self._execute(goals, task_skip = self._maybe_skip())
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/tool/taskengine.py", line 114, in _execute
[translation:info]     res = self._do(goal, taskcallable, *args, **kwds)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/driver.py", line 276, in _do
[translation:info]     res = func()
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/driver.py", line 313, in task_annotate
[translation:info]     s = annotator.build_types(self.entry_point, self.inputtypes)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/annrpython.py", line 82, in build_types
[translation:info]     flowgraph, inputcells = self.get_call_parameters(function, args_s, policy)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/annrpython.py", line 103, in get_call_parameters
[translation:info]     desc.pycall(schedule, args, annmodel.s_ImpossibleValue)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/description.py", line 301, in pycall
[translation:info]     result = self.specialize(inputcells, op)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/description.py", line 297, in specialize
[translation:info]     return self.specializer(self, inputcells)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/specialize.py", line 80, in default_specialize
[translation:info]     graph = funcdesc.cachedgraph(key, builder=builder)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/description.py", line 245, in cachedgraph
[translation:info]     graph = self.buildgraph(alt_name, builder)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/description.py", line 208, in buildgraph
[translation:info]     graph = translator.buildflowgraph(self.pyobj)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/translator.py", line 54, in buildflowgraph
[translation:info]     graph = build_flow(func)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/flowspace/objspace.py", line 42, in build_flow
[translation:info]     ctx.build_flow()
[translation:info]    File "/media/ryan/stuff/pypy/rpython/flowspace/flowcontext.py", line 448, in build_flow
[translation:info]     self.record_block(block)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/flowspace/flowcontext.py", line 456, in record_block
[translation:info]     next_pos = self.handle_bytecode(next_pos)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/flowspace/flowcontext.py", line 548, in handle_bytecode
[translation:info]     res = getattr(self, methodname)(oparg)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/flowspace/flowcontext.py", line 266, in BINARY_OP
[translation:info]     w_result = operation(w_1, w_2).eval(self)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/flowspace/operation.py", line 91, in eval
[translation:info]     result = self.constfold()
[translation:info]    File "/media/ryan/stuff/pypy/rpython/flowspace/operation.py", line 121, in constfold
[translation:info]     raise FlowingError(msg)
[translation:ERROR] FlowingError:
[translation:ERROR]
[translation:ERROR] add(None, 1) always raises &lt;type 'exceptions.TypeError'&gt;: unsupported operand type(s) for +: 'NoneType' and 'int'
[translation:ERROR]
[translation:ERROR] In &lt;FunctionGraph of (nl:1)entry_point at 0x7f988a349090&gt;:
[translation:ERROR] Happened at file nl.py line 6
[translation:ERROR]
[translation:ERROR]         print x+1+2 # compile-time error
[translation:ERROR]
</pre>
<p>Wow! RPython's exceptions generally go like this:</p>
<div class="section" id="flowingerror">
<h3>FlowingError</h3>
<p>RPython can prove at compile-time that some run-time computation may fail. This usually means one of:</p>
<ul class="simple">
<li>You're referencing a variable you never defined (the error message will go something like <tt class="docutils literal">global variable 'x' is not defined</tt>).</li>
<li>You're trying to get the <tt class="docutils literal">len</tt> of <tt class="docutils literal">None</tt>.</li>
</ul>
</div>
<div class="section" id="unionerror">
<h3>UnionError</h3>
<p>A type conflict. Whenever you get this, RPython will show the internal types that caused the error.</p>
<p>Take this program:</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">b</span> <span class="k">else</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">entry_point</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">f</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span> <span class="c"># compile-time error</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">entry_point</span><span class="p">,</span> <span class="bp">None</span>
</pre>
<p>RPython gives this error message:</p>
<pre class="literal-block">
[translation:info] Error:
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/goal/translate.py", line 316, in main
[translation:info]     drv.proceed(goals)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/driver.py", line 539, in proceed
[translation:info]     return self._execute(goals, task_skip = self._maybe_skip())
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/tool/taskengine.py", line 114, in _execute
[translation:info]     res = self._do(goal, taskcallable, *args, **kwds)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/driver.py", line 276, in _do
[translation:info]     res = func()
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/driver.py", line 313, in task_annotate
[translation:info]     s = annotator.build_types(self.entry_point, self.inputtypes)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/annrpython.py", line 89, in build_types
[translation:info]     return self.build_graph_types(flowgraph, inputcells, complete_now=complete_now)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/annrpython.py", line 143, in build_graph_types
[translation:info]     self.complete()
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/annrpython.py", line 197, in complete
[translation:info]     self.complete_pending_blocks()
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/annrpython.py", line 192, in complete_pending_blocks
[translation:info]     self.processblock(graph, block)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/annrpython.py", line 338, in processblock
[translation:info]     self.flowin(graph, block)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/annrpython.py", line 473, in flowin
[translation:info]     self.follow_link(graph, link, knowntypedata)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/annrpython.py", line 561, in follow_link
[translation:info]     self.addpendingblock(graph, link.target, inputs_s)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/annrpython.py", line 185, in addpendingblock
[translation:info]     self.mergeinputargs(graph, block, cells)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/annrpython.py", line 375, in mergeinputargs
[translation:info]     unions = [annmodel.unionof(c1,c2) for c1, c2 in zip(oldcells,inputcells)]
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/model.py", line 658, in unionof
[translation:info]     s1 = pair(s1, s2).union()
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/binaryop.py", line 755, in union
[translation:info]     return obj.noneify()
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/model.py", line 126, in noneify
[translation:info]     raise UnionError(self, s_None)
[translation:ERROR] UnionError:
[translation:ERROR]
[translation:ERROR] Offending annotations:
[translation:ERROR]   SomeInteger(const=1, knowntype=int, nonneg=True, unsigned=False)
[translation:ERROR]   SomeNone()
[translation:ERROR]
[translation:ERROR] In &lt;FunctionGraph of (nl2:1)f at 0x7f6801abdb50&gt;:
[translation:ERROR] &lt;return block&gt;
[translation:ERROR] Processing block:
[translation:ERROR]  block@3 is a &lt;class 'rpython.flowspace.flowcontext.SpamBlock'&gt;
[translation:ERROR]  in (nl2:1)f
[translation:ERROR]  containing the following operations:
[translation:ERROR]        v0 = bool(b_0)
[translation:ERROR]  --end--
</pre>
<p>This tells us that the type conflict is between an integer and <tt class="docutils literal">None</tt>. Also note that there are no absolute line numbers. RPython will sometimes show just the function where the error occurred (in this case, <tt class="docutils literal">f</tt>) and the internal, simplified code that is near the cause of there error.</p>
<p>These errors often show much more info:</p>
<ul class="simple">
<li>The integer is the constant <tt class="docutils literal">1</tt>.</li>
<li>It is non-negative (<tt class="docutils literal">nonneg=True</tt>) but signed (<tt class="docutils literal">unsigned=False</tt>).</li>
</ul>
</div>
<div class="section" id="blockerror">
<h3>BlockError</h3>
<p>This means that type inference couldn't succeed. Take this program:</p>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">rd</span><span class="p">():</span>
    <span class="s">'Read all of stdin'</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">buf</span> <span class="o">==</span> <span class="s">''</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">buf</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="k">def</span> <span class="nf">entry_point</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">rd</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)</span>
    <span class="k">print</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="mf">2.3</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">entry_point</span><span class="p">,</span> <span class="bp">None</span>
</pre>
<p>This reads one or more numbers from <cite>stdin</cite> and prints the first one added to <tt class="docutils literal">2.3</tt>. You may have noticed an error in the program. When compiling, this happens:</p>
<pre class="literal-block">
[translation:info] Error:
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/goal/translate.py", line 316, in main
[translation:info]     drv.proceed(goals)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/driver.py", line 539, in proceed
[translation:info]     return self._execute(goals, task_skip = self._maybe_skip())
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/tool/taskengine.py", line 114, in _execute
[translation:info]     res = self._do(goal, taskcallable, *args, **kwds)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/driver.py", line 276, in _do
[translation:info]     res = func()
[translation:info]    File "/media/ryan/stuff/pypy/rpython/translator/driver.py", line 313, in task_annotate
[translation:info]     s = annotator.build_types(self.entry_point, self.inputtypes)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/annrpython.py", line 89, in build_types
[translation:info]     return self.build_graph_types(flowgraph, inputcells, complete_now=complete_now)
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/annrpython.py", line 143, in build_graph_types
[translation:info]     self.complete()
[translation:info]    File "/media/ryan/stuff/pypy/rpython/annotator/annrpython.py", line 219, in complete
[translation:info]     raise annmodel.AnnotatorError(text)
[translation:ERROR] AnnotatorError:
[translation:ERROR]
[translation:ERROR] Blocked block -- operation cannot succeed
[translation:ERROR]
[translation:ERROR]     v1 = getslice(v0, (None), (-1))
[translation:ERROR]
[translation:ERROR] In &lt;FunctionGraph of (nn:12)entry_point at 0x7f7558a750d0&gt;:
[translation:ERROR] Happened at file nn.py line 13
[translation:ERROR]
[translation:ERROR] ==&gt;     data = rd()[:-1].split(' ')
[translation:ERROR]         print float(data[0])+2.3
[translation:ERROR]
[translation:ERROR] Known variable annotations:
[translation:ERROR]  v0 = SomeNone()
[translation:ERROR]
</pre>
<p>What?? What RPython means is that it can't infer the type of <tt class="docutils literal">data</tt>. Why? Because somewhere in <tt class="docutils literal">rd</tt> we put a plain <tt class="docutils literal">return</tt>. In Python, this returns <tt class="docutils literal">None</tt>. In RPython? It's an error.</p>
<p>One gotcha about these errors is that they occur when the type problems surface. Notice that the error didn't occur in <tt class="docutils literal">rd</tt>'s definition; it occurred when we tried to slice it. This can be a little odd until you get the hang of it.</p>
</div>
<div class="section" id="assertionerror">
<h3>AssertionError</h3>
<p>Various meanings. Sometimes they have an error message; sometimes they don't. When they don't, your best bet is to go to the line in RPython source that raised the error and look for any helpful comments or try to figure out on your own.</p>
</div>
<div class="section" id="annotatorerror">
<h3>AnnotatorError</h3>
<p>This may have various meanings, but it basically means that an error occurred while trying to annotate the types. The most common reason in my experience is an attribute error. For instance, this:</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">entry_point</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">argv</span><span class="o">.</span><span class="n">x</span>
    <span class="k">return</span> <span class="mi">0</span>
</pre>
<p>Gives:</p>
<pre class="literal-block">
[translation:ERROR] AnnotatorError:
[translation:ERROR]
[translation:ERROR] Cannot find attribute 'x' on SomeList(listdef=&lt;[SomeString(no_nul=True)]mr&gt;)
[translation:ERROR]
[translation:ERROR]
[translation:ERROR]     v0 = getattr(argv_0, ('x'))
[translation:ERROR]
[translation:ERROR] In &lt;FunctionGraph of (nn:1)entry_point at 0x7feeac22e090&gt;:
[translation:ERROR] Happened at file nn.py line 2
[translation:ERROR]
[translation:ERROR] ==&gt;     print argv.x
[translation:ERROR]
[translation:ERROR] Known variable annotations:
[translation:ERROR]  argv_0 = SomeList(listdef=&lt;[SomeString(no_nul=True)]mr&gt;)
[translation:ERROR]
[translation:ERROR] Processing block:
[translation:ERROR]  block@3 is a &lt;class 'rpython.flowspace.flowcontext.SpamBlock'&gt;
[translation:ERROR]  in (nn:1)entry_point
[translation:ERROR]  containing the following operations:
[translation:ERROR]        v0 = getattr(argv_0, ('x'))
[translation:ERROR]        v1 = str(v0)
[translation:ERROR]        v2 = simple_call((function rpython_print_item), v1)
[translation:ERROR]        v3 = simple_call((function rpython_print_newline))
[translation:ERROR]  --end--
</pre>
<p>Also note the types again. Here, it's telling us it's a list (<tt class="docutils literal">SomeList</tt>) of non-nullable strings (<tt class="docutils literal"><span class="pre">listdef=&lt;[SomeString(no_nul=True)]&gt;</span></tt>).</p>
</div>
</div>
<div class="section" id="rpython-takes-a-hint">
<h2>RPython takes a hint</h2>
<p>For instance:</p>
<pre class="code python literal-block">
<span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="s">'y'</span>

<span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="s">'z'</span>

<span class="k">def</span> <span class="nf">entry_point</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">else</span> <span class="n">B</span><span class="p">()</span> <span class="c"># Ok; 'a' is of type A</span>
    <span class="k">print</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">()</span> <span class="c"># Error! RPython can't prove that 'a' is of type B, so it doesn't know which signature of 'x' to use</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">entry_point</span><span class="p">,</span> <span class="bp">None</span>
</pre>
<p>This gives:</p>
<pre class="literal-block">
[translation:ERROR] AnnotatorError:
[translation:ERROR]
[translation:ERROR] signature mismatch: x() takes exactly 2 arguments (1 given)
[translation:ERROR]
[translation:ERROR]
[translation:ERROR] Occurred processing the following simple_call:
[translation:ERROR]   &lt;MethodDesc 'x' of &lt;ClassDef 'nn.C'&gt; bound to &lt;ClassDef 'nn.C'&gt; {}&gt; returning
[translation:ERROR]
[translation:ERROR]     v1 = simple_call(v0)
[translation:ERROR]
[translation:ERROR] In &lt;FunctionGraph of (nn:10)entry_point at 0x7f1c3d7081d0&gt;:
[translation:ERROR] Happened at file nn.py line 12
[translation:ERROR]
[translation:ERROR] ==&gt;     print a.x() # Error! RPython can't prove that 'a' is of type B
[translation:ERROR]
[translation:ERROR] Known variable annotations:
[translation:ERROR]  v0 = SomePBC(can_be_None=False, descriptions={...1...}, knowntype=instancemethod, subset_of=None)
[translation:ERROR]
[translation:ERROR] Processing block:
[translation:ERROR]  block@39 is a &lt;class 'rpython.flowspace.flowcontext.SpamBlock'&gt;
[translation:ERROR]  in (nn:10)entry_point
[translation:ERROR]  containing the following operations:
[translation:ERROR]        v0 = getattr(v2, ('x'))
[translation:ERROR]        v1 = simple_call(v0)
[translation:ERROR]        v3 = str(v1)
[translation:ERROR]        v4 = simple_call((function rpython_print_item), v3)
[translation:ERROR]        v5 = simple_call((function rpython_print_newline))
[translation:ERROR]  --end--
</pre>
<p>The solution? You can use an assertion:</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">entry_point</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">else</span> <span class="n">B</span><span class="p">()</span> <span class="c"># Ok; 'a' is of type A</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">()</span> <span class="c"># Ok; this will never run if 'a' is of type 'C'</span>
    <span class="k">return</span> <span class="mi">0</span>
</pre>
<p>Or an <tt class="docutils literal">if</tt> statement:</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">entry_point</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">else</span> <span class="n">B</span><span class="p">()</span> <span class="c"># Ok; 'a' is of type A</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
        <span class="k">print</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
        <span class="k">print</span> <span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span>
</pre>
</div>
<div class="section" id="rpython-drops-you-some-neat-info">
<h2>RPython drops you some neat info</h2>
<p>Notice that, when an error occurs, RPython drops you into an instance of <a class="reference external" href="https://docs.python.org/2/library/pdb.html">pdb</a>. This means you can inspect the variables of RPython's internals! This can come in handy for debugging the more spurious errors. You can inspect the various variables and see what RPython thinks things are.</p>
</div>
<div class="section" id="rpython-is-polite">
<h2>RPython is polite</h2>
<p>Take this program:</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">entry_point</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">entry_point</span><span class="p">,</span> <span class="bp">None</span>
</pre>
<p>If you give it no arguments, it'll throw an <tt class="docutils literal">IndexError</tt>, right? WRONG! If I build it without optimizations, it'll print <tt class="docutils literal">None</tt>; if I use optimizations (<tt class="docutils literal"><span class="pre">-O2</span></tt>), it'll segfault. Why? See, it would be rude to throw an exception! After all, you asked it for the first argument. Therefore, it returns a safe value: <tt class="docutils literal">None</tt>. However, when you build it with optimizations, RPython couldn't care less about your computers memory, so it happily...crashes. However, try this:</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">entry_point</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">'Too few arguments!'</span>
    <span class="k">return</span> <span class="mi">0</span>
</pre>
<p>This will correctly print "Too few arguments!" if given no arguments. See, now that you put a <tt class="docutils literal">try</tt> block around it, RPython knows you want an exception, so it'll throw one.</p>
<p>However, take this:</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">entry_point</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">f</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">'Too few arguments!'</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">entry_point</span><span class="p">,</span> <span class="bp">None</span>
</pre>
<p>This will segfault when build with <tt class="docutils literal"><span class="pre">-O2</span></tt>. But we put a <tt class="docutils literal">try</tt> block! RPython analyses the function individually in this case, so it doesn't pick up the <tt class="docutils literal">try</tt> block in <tt class="docutils literal">entry_point</tt>. To circumvent this, put another <tt class="docutils literal">try</tt> block around <tt class="docutils literal">f</tt> that explicitly re-raises any errors:</p>
<pre class="code python literal-block">
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span>
</pre>
</div>
<div class="section" id="rpython-is-very-restricted">
<h2>RPython is very restricted</h2>
<p>Here are a few things that don't work:</p>
<ul class="simple">
<li>Any builtins not found as <tt class="docutils literal">builtin_xxx</tt> in <a class="reference external" href="https://bitbucket.org/pypy/pypy/src/default/rpython/annotator/builtin.py">rpython/annotator/builtin.py</a>.</li>
<li>Printing unicode strings (use <tt class="docutils literal">print <span class="pre">string.encode('utf-8')</span></tt>).</li>
<li>Slicing any negative indices other than <tt class="docutils literal"><span class="pre">-1</span></tt>. If RPython can't prove an index isn't non-negative or <tt class="docutils literal"><span class="pre">-1</span></tt>, a compile-time error will be thrown. You can use an assertion (like <tt class="docutils literal">assert the_index &gt;= 0</tt>; see the above section on hints).</li>
<li>Most Python modules other than <tt class="docutils literal">os</tt> and <tt class="docutils literal">math</tt> (and maybe a few others).</li>
<li>Sets.</li>
<li>Multiple inheritance.</li>
<li>Several <tt class="docutils literal">str</tt> methods (such as <tt class="docutils literal">*just</tt> and <tt class="docutils literal">zfill</tt>). Some others work take slightly different argument counts.</li>
<li>
<tt class="docutils literal">with</tt> blocks. Use <tt class="docutils literal"><span class="pre">try..finally</span></tt>.</li>
<li>
<tt class="docutils literal">sys.stdin</tt>, <tt class="docutils literal">sys.stdout</tt>, and <tt class="docutils literal">sys.stderr</tt>.</li>
<li>
<tt class="docutils literal">raw_input</tt>.</li>
<li>Lots and lots and lots of other stuff!</li>
</ul>
<p>I believe <tt class="docutils literal">OrderedDict</tt> works, but I'm not quite sure.</p>
<p>Figuring some of the other restrictions is simply trial-and-error.</p>
<p>For getting around <tt class="docutils literal">sys.std*</tt>, you can use this function to read a line from <tt class="docutils literal">stdin</tt>:</p>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">readline</span><span class="p">():</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">buf</span><span class="p">:</span> <span class="k">return</span> <span class="n">res</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">buf</span>
        <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">:</span> <span class="k">return</span> <span class="n">res</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre>
<p>For reading all the lines in <tt class="docutils literal">stdin</tt> into a list:</p>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">readlines</span><span class="p">():</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">buf</span><span class="p">:</span> <span class="k">return</span> <span class="n">res</span>
        <span class="n">cur</span> <span class="o">+=</span> <span class="n">buf</span>
        <span class="k">if</span> <span class="n">cur</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">:</span> <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cur</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre>
<p>For reading the lines in <tt class="docutils literal">stdin</tt> into a single string:</p>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">readall</span><span class="p">():</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">buf</span><span class="p">:</span> <span class="k">return</span> <span class="n">res</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">buf</span>
</pre>
<p>For writing to <tt class="docutils literal">stderr</tt>:</p>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">write_err</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">msg</span><span class="o">+</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
</pre>
<p>And for writing to <tt class="docutils literal">stdout</tt> without any trailing newlines or spaces:</p>
<pre class="code python literal-block">
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
</pre>
</div>
<div class="section" id="rpython-is-fun">
<h2>RPython is fun!</h2>
<p>Maybe I'm weird, but RPython is still really cool. Once you get the hang of the oddities, everything else kind of starts to fall into place.</p>
</div>
<div class="section" id="need-help">
<h2>Need help?</h2>
<p>You can ask the <a class="reference external" href="https://mail.python.org/mailman/listinfo/pypy-dev">PyPy mailing list</a>. They helped me with several slip-ups while writing an interpreter in RPython.</p>
<div class="section" id="read-the-docs">
<h3>Read the docs!</h3>
<p>Also, read through the <a class="reference external" href="http://rpython.readthedocs.org/en/latest/">RPython</a> documentation. It's very exhaustive and mentions stuff that I can't in this short space.</p>
</div>
</div>
    </div>
    <aside class="postpromonav">
    <nav>
    

    
        <ul class="pager">
            <li class="previous">
                <a href="functional-programming-isnt-the-answer-to-all-problems-and-neither-is-oop.html" rel="prev" title="Functional programming isn't the answer to all problems (and neither is OOP)">Previous post</a>
            </li>
            <li class="next">
                <a href="programming-decisions.html" rel="next" title="Programming Decisions">Next post</a>
            </li>
        </ul>

    </nav>
    </aside>
        <section class="comments">
        <h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="blockbyte",
            disqus_url="http://kirbyfan64.github.io/posts/the-magic-of-rpython.html",
        disqus_title="The Magic of RPython",
        disqus_identifier="cache/posts/the-magic-of-rpython.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section>
    

</article>

        
       <script>var disqus_shortname="blockbyte";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>



        </div>
        <!--End of body content-->

        <footer>
            Contents  2016         <a href="mailto:rymg19@gmail.com">Ryan Gonzalez</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
    </div>
</div>


            <script src="../assets/js/all-nocdn.js"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55018880-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>
